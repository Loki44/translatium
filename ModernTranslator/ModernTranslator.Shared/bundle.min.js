!function(){"use strict";function b(t,e){for(var n=0;n<e.length-2;n+=3){var i=e.charAt(n+2),i=i>="a"?i.charCodeAt(0)-87:Number(i),i="+"==e.charAt(n+1)?t>>>i:t<<i;t="+"==e.charAt(n)?t+i&4294967295:t^i}return t}function TL(t,e){for(var n=t.split("."),i=Number(n[0])||0,s=[],a=0,o=0;o<e.length;o++){var r=e.charCodeAt(o);128>r?s[a++]=r:(2048>r?s[a++]=r>>6|192:(55296==(64512&r)&&o+1<e.length&&56320==(64512&e.charCodeAt(o+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++o)),s[a++]=r>>18|240,s[a++]=r>>12&63|128):s[a++]=r>>12|224,s[a++]=r>>6&63|128),s[a++]=63&r|128)}for(e=i,a=0;a<s.length;a++)e+=s[a],e=b(e,"+-a^+6");return e=b(e,"+-3^+b+-f"),e^=Number(n[1])||0,0>e&&(e=(2147483647&e)+2147483648),e%=1e6,e.toString()+"."+(e^i)}var utils=WinJS.Utilities,nav=WinJS.Navigation,app=WinJS.Application,applicationData=Windows.Storage.ApplicationData.current,localSettings=applicationData.localSettings;WinJS.Namespace.define("Custom.Control",{Theme_X:WinJS.Class.define(function(t,e){if(this.element=t,t.winControl=this,this.name=this.element.getAttribute("aria-name"),this.hex=this.element.getAttribute("aria-hex"),this.thex=this.element.getAttribute("aria-thex"),this.element.className="color-box left",this.element.style.backgroundColor=this.hex,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.name==localSettings.values["x-theme"]){var n=document.createElement("i");n.className="md md-done",n.style.color=this.thex,this.element.appendChild(n)}var i=document.createElement("span");i.innerText=this.name,i.style.color=this.thex,this.element.appendChild(i),this.element.onclick=this._changeThemeX.bind(this)},{_changeThemeX:function(){if(this.name!=localSettings.values["x-theme"]){var t=this.name,e=localSettings.values["x-theme"];localSettings.values["x-theme"]=t,Custom.UI.applyTheme(),Custom.Data.themeXList.every(function(t,n){if(t.name==e){var i=Custom.Data.themeXList.getAt(n);return Custom.Data.themeXList.splice(n,1,i),!1}return!0}),Custom.Data.themeXList.every(function(e,n){if(e.name==t){var i=Custom.Data.themeXList.getAt(n);return Custom.Data.themeXList.splice(n,1,i),!1}return!0})}},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Theme_Y:WinJS.Class.define(function(t,e){if(this.element=t,t.winControl=this,this.name=this.element.getAttribute("aria-name"),this.hex=this.element.getAttribute("aria-hex"),this.element.className="color-box left",this.element.style.backgroundColor=this.hex,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.name==localSettings.values["y-theme"]){var n=document.createElement("i");n.className="md md-done",this.element.appendChild(n)}this.element.onclick=this._changeThemeY.bind(this)},{_changeThemeY:function(){if(this.name!=localSettings.values["y-theme"]){var t=this.name,e=localSettings.values["y-theme"];localSettings.values["y-theme"]=t,Custom.UI.applyTheme(),Custom.UI.applyStatusbar(),Custom.Data.themeYList.every(function(t,n){if(t.name==e){var i=Custom.Data.themeYList.getAt(n);return Custom.Data.themeYList.splice(n,1,i),!1}return!0}),Custom.Data.themeYList.forEach(function(e,n){if(e.name==t){var i=Custom.Data.themeYList.getAt(n);return Custom.Data.themeYList.splice(n,1,i),!1}return!0})}},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Listen:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"md-volume-up"),utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.player=document.createElement("audio"),this.element.onclick=this._handleClick.bind(this)},{_playSound:function(){var t=this;return new WinJS.Promise(function(e,n,i){t.player.play(),t.player.onended=function(){e()}})},getGoogleTkk:function(){if(null===sessionStorage.getItem("googleTkk")){var url="https://translate.google.com";return WinJS.xhr({url:url,responseType:"text"}).then(function(t){return t.response}).then(function(body){var startStr="TKK=eval(",endStr=");WEB_TRANSLATION_PATH=",startI=body.indexOf(startStr)+startStr.length,endI=body.indexOf(endStr),tkkEval=body.substring(startI,endI),x=eval(eval(tkkEval));return sessionStorage.setItem("googleTkk",x),sessionStorage.getItem("googleTkk")})}return WinJS.Promise.as(sessionStorage.getItem("googleTkk"))},_loadPart:function(t,e,n,i){var s=this;return WinJS.Promise.as().then(function(){return Custom.Utils.showNotif(WinJS.Resources.getString("loading_sound").value),s.getGoogleTkk().then(function(s){console.log(s);var a=encodeURI("https://translate.google.com/translate_tts?ie=UTF-8&tl="+t+"&q="+e+"&textlen="+e.length+"&idx="+n+" &total="+i+"&client=t&prev=input&tk="+TL(s,e));return WinJS.xhr({url:a,responseType:"blob"})}).then(function(t){return t.response}).then(function(t){if(t){var e=URL.createObjectURL(t,{oneTimeOnly:!0});return s.player.src=e,s._playSound().then(function(){return!0})}throw"fail to get blob"}).then(function(t){return!0})})},_splitToParts:function(t,e){var n=this;return WinJS.Promise.as().then(function(){for(var t=[];e.length>0;){if(e.length>100){var n=e.substr(0,99),i=n.lastIndexOf(" ");-1==i&&(i=n.length-1);var s=n.substr(0,i)}else var s=e;t.push(s),e=e.substr(s.length)}return t}).then(function(e){var i=0,s=function(){return n._loadPart(t,e[i],i,e.length).then(function(t){return 1==t&&i<e.length-1?(i++,s()):void 0})};return s()})},_handleClick:function(){var t=this,e=this.element,n=this.lang,i=this.text;0!=i.length&&(utils.hasClass(e,"md-volume-up")?(utils.removeClass(e,"md-volume-up"),utils.addClass(e,"md-stop"),window.soundPromise&&window.soundPromise.cancel(),window.soundPromise=this._splitToParts(n,i).then(function(){utils.addClass(e,"md-volume-up"),utils.removeClass(e,"md-stop"),t.player.src="",Custom.Utils.hideNotif()},function(n){"Canceled"!=n.name&&Custom.Utils.popupNoInternet(),utils.addClass(e,"md-volume-up"),utils.removeClass(e,"md-stop"),t.player.src="",Custom.Utils.hideNotif()})):window.soundPromise&&window.soundPromise.cancel())},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Suggestion:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._useSuggestion.bind(this)},{suggestedinputText:{get:function(){return this._suggestedinputText},set:function(t){this._suggestedinputText=t,this._setup()}},_setup:function(){return this.suggestedinputText?(this.element.innerHTML=toStaticHTML(WinJS.Resources.getString("did_you_mean").value.replace("{1}","<span style='text-decoration: underline;'>"+this.suggestedinputText+"</span>")),void(this.element.hidden=!1)):this.suggestedinputLang&&this.suggestedinputLang!=this.inputLang?(this.element.innerHTML=toStaticHTML(WinJS.Resources.getString("translate_from").value.replace("{1}","<span style='text-decoration: underline;'>"+WinJS.Resources.getString(this.suggestedinputLang).value+"</span>")),void(this.element.hidden=!1)):void(this.element.hidden=!0)},_useSuggestion:function(){return this.suggestedinputText?(Custom.Navigation.navigator.pageControl.inputBox.value=this.suggestedinputText,void(Custom.Navigation.navigator.pageControl.bindingData.inputText=this.suggestedinputText)):this.suggestedinputLang?void(Custom.Navigation.navigator.pageControl.bindingData.inputLang=this.suggestedinputLang):void 0},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Delete:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._deleteHistory.bind(this)},{_deleteHistory:function(t){var e=this.id,n="DELETE FROM history WHERE id="+e;Custom.SQLite.localDatabase.executeAsync(n).then(function(){Custom.Navigation.navigator.pageControl.bindingData.historyList.every(function(t,n){return t.id==e?(Custom.Navigation.navigator.pageControl.bindingData.historyList.splice(n,1),!1):!0}),0==Custom.Navigation.navigator.pageControl.bindingData.historyList.length&&Custom.Navigation.navigator.pageControl.bindingData.loadmoreHistory()})},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Star_in_History:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._toggleFavorite.bind(this)},{id:{get:function(){return this._id},set:function(t){if(this._id=t,t){var e=this.element,n="SELECT COUNT(1) FROM favorites WHERE history_id="+t;Custom.SQLite.localDatabase.executeAsync(n).then(function(t){var n=t[0].getFirstValueByName("COUNT(1)");0==n?(utils.removeClass(e,"md-star"),utils.addClass(e,"md-star-outline")):(utils.removeClass(e,"md-star-outline"),utils.addClass(e,"md-star"))})}}},_toggleFavorite:function(t){var e=this.element,n=this.id;return utils.hasClass(e,"md-star-outline")?(utils.removeClass(e,"md-star-outline"),utils.addClass(e,"md-star"),WinJS.Promise.as().then(function(){var t="SELECT * FROM history WHERE id = "+n+" LIMIT 0,1";return Custom.SQLite.localDatabase.executeAsync(t)}).then(function(t){var e=Custom.SQLite.entriestoObj(t[0].entries);return e.history_id=e.id,delete e.id,Custom.SQLite.insertObject(Custom.SQLite.localDatabase,"favorites",e)})):(utils.addClass(e,"md-star-outline"),utils.removeClass(e,"md-star"),WinJS.Promise.as().then(function(){var t="DELETE FROM favorites WHERE history_id = "+n;return Custom.SQLite.localDatabase.executeAsync(t)}))},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Star_in_Favorites:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"md-star"),utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._removeFavorite.bind(this)},{_removeFavorite:function(t){var e=this.element,n=this.id;return utils.addClass(e,"md-star-outline"),utils.removeClass(e,"md-star"),Custom.Navigation.navigator.pageControl.bindingData.favoriteList.every(function(t,e){return t.id==n?(Custom.Navigation.navigator.pageControl.bindingData.favoriteList.splice(e,1),!1):!0}),WinJS.Promise.as().then(function(){var t="DELETE FROM favorites WHERE id = "+n;return Custom.SQLite.localDatabase.executeAsync(t)})},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Copy:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._showOptions.bind(this)},{_copyFunc:function(t){if(Custom.Device.isPhone){var e=new Windows.Foundation.Uri("clipboard:Set?Text="+encodeURIComponent(t));return Windows.System.Launcher.launchUriAsync(e)}var n=new Windows.ApplicationModel.DataTransfer.DataPackage;n.setText(t),Windows.ApplicationModel.DataTransfer.Clipboard.setContent(n)},_showOptions:function(t){var e=this,n=new Windows.UI.Popups.PopupMenu;n.commands.append(new Windows.UI.Popups.UICommand(WinJS.Resources.getString("original_text").value,function(){e._copyFunc(e.inputText)})),n.commands.append(new Windows.UI.Popups.UICommand(WinJS.Resources.getString("translated_text").value,function(){e._copyFunc(e.outputText)})),n.commands.append(new Windows.UI.Popups.UICommand(WinJS.Resources.getString("both").value,function(){e._copyFunc(e.inputText+"\r\n"+e.outputText)}));var i=document.documentElement.msContentZoomFactor;n.showAsync({x:(t.pageX-window.pageXOffset)*i,y:(t.pageY-window.pageYOffset)*i})},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Share:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._showOptions.bind(this)},{_shareFunc:function(t){var e=Windows.ApplicationModel.DataTransfer.DataTransferManager.getForCurrentView();e.ondatarequested=function(n){var i=n.request;i.data.properties.title="\x00",i.data.properties.description="\x00",i.data.setText(t),e.ondatarequested=null},Windows.ApplicationModel.DataTransfer.DataTransferManager.showShareUI()},_showOptions:function(t){var e=this,n=new Windows.UI.Popups.PopupMenu;n.commands.append(new Windows.UI.Popups.UICommand(WinJS.Resources.getString("original_text").value,function(){e._shareFunc(e.inputText)})),n.commands.append(new Windows.UI.Popups.UICommand(WinJS.Resources.getString("translated_text").value,function(){e._shareFunc(e.outputText)})),n.commands.append(new Windows.UI.Popups.UICommand(WinJS.Resources.getString("both").value,function(){e._shareFunc(e.inputText+"\r\n"+e.outputText)}));var i=document.documentElement.msContentZoomFactor;n.showAsync({x:(t.pageX-window.pageXOffset)*i,y:(t.pageY-window.pageYOffset)*i})},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Zoom:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.element.onclick=this._showZoom.bind(this)},{_showZoom:function(){nav.navigate("/pages/p-zoom/p-zoom.html",{text:this.text})},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.element.onclick=null)}}),Write:WinJS.Class.define(function(t,e){var n=this;this.element=t,t.winControl=this,utils.addClass(this.element,"write-control"),utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.recogList=new WinJS.Binding.List([]),this.recog=document.createElement("div"),this.recog.className="recog-list",this.recogLv=new WinJS.UI.ListView(this.recog,{itemDataSource:this.recogList.dataSource,itemTemplate:utils.markSupportedForProcessing(function(t){return t.then(function(t){var e=document.createElement("div");return utils.addClass(e,"suggest"),e.innerText=t.data.text,e})}),oniteminvoked:utils.markSupportedForProcessing(function(t){n.callEvent(0,n.recogList.getAt(t.detail.itemIndex).text),n.callEvent(2),n.clearAll()})}),this.element.appendChild(this.recog),this.canvas=document.createElement("canvas"),this.element.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this.context.canvas.height=this.canvas.clientHeight,this.context.canvas.width=this.canvas.clientWidth,this.context.strokeStyle="#fff",this.context.lineJoin="round",this.context.lineWidth=5,this.action=document.createElement("div"),this.action.className="action",this.backSpace=document.createElement("i"),this.backSpace.className="md md-backspace material-grid-col-1",this.backSpace.onclick=function(t){n.clearAll(),n.callEvent(1)},this.action.appendChild(this.backSpace),this.spaceBar=document.createElement("div"),this.spaceBar.className="space-bar material-grid-col-2",this.spaceBar.innerText="space",this.spaceBar.onclick=function(){n.clearAll(),n.callEvent(2),n.callEvent(0," "),n.callEvent(2)},this.action.appendChild(this.spaceBar),this.doneKey=document.createElement("i"),this.doneKey.className="md md-check material-grid-col-3",this.doneKey.onclick=function(){n.clearAll(),n.callEvent(2)},this.action.appendChild(this.doneKey),this.element.appendChild(this.action);var i=this.canvas.offsetParent.offsetTop+48,s=this.canvas.offsetParent.offsetLeft;this.clearAll(),this.canvas.onmousedown=function(t){n.paint=!0,n.addClick(t.pageX-s,t.pageY-i)},this.canvas.onmousemove=function(t){n.paint&&n.addClick(t.pageX-s,t.pageY-i,!0)},this.canvas.onmouseup=function(t){n.paint=!1,n.clickInk.push([n.clickX,n.clickY,n.clickZ]),n.clickX=new Array,n.clickY=new Array,n.clickZ=new Array,n.getHandwriting()},this.canvas.onmouseleave=function(t){n.paint=!1}},{dlist:[",",".","?","!",":","'",'"',";","@"],callEvent:function(t,e){this.dispatchEvent("edit",{eType:t,eText:e})},getHandwriting:function(){var t=this;this._promise&&this._promise.cancel(),this._promise=WinJS.Promise.as().then(function(){var e="undefined"!=typeof localSettings.values.https?localSettings.values.https:!1,n=1==e?"https":"http",i=n+"://www.google.com/inputtools/request?ime=handwriting&app=mobilesearch&cs=1&oe=UTF-8",s={device:"Mozilla/5.0 (Linux; Android 4.0.4; GT-i9100 Build/IML74K) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.49 Mobile Safari/537.31 ApiKey/1.257",options:"enable_pre_space",requests:[{writing_guide:{writing_area_width:t.context.canvas.width,writing_area_height:t.context.canvas.height},ink:t.clickInk,language:localSettings.values.inputLang}]};return Custom.Utils.showNotif(WinJS.Resources.getString("recognizing").value),WinJS.xhr({type:"post",url:i,headers:{"Content-Type":"application/json"},data:JSON.stringify(s)})}).then(function(t){return t?JSON.parse(t.response)[1][0][1]:void 0}).then(function(e){t.recogList&&e.length>0&&(t.recogList.splice(0,t.recogList.length),e.forEach(function(e){t.recogList.push({text:e})}),t.callEvent(0,e[0]))}).then(null,function(t){"Canceled"!=t.name&&Custom.Utils.popupNoInternet()}).then(function(){Custom.Utils.hideNotif()},function(){Custom.Utils.hideNotif()})},clearAll:function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.clickInk=new Array,this.clickX=new Array,this.clickY=new Array,this.clickZ=new Array,this.clickDrag=new Array,this.startTime=(new Date).getTime(),this.paint=!1;var t=this.recogList;t.splice(0,t.length),this.dlist.forEach(function(e){t.push({text:e})})},addClick:function(t,e,n){this.clickX.push(Math.round(t)),this.clickY.push(Math.round(e)),this.clickDrag.push(n);var i=(new Date).getTime();this.clickZ.push(i-this.startTime);var s=this.clickX.length-1;this.context.beginPath(),this.clickDrag[s]&&s?this.context.moveTo(this.clickX[s-1],this.clickY[s-1]):this.context.moveTo(this.clickX[s]-1,this.clickY[s]),this.context.lineTo(this.clickX[s],this.clickY[s]),this.context.closePath(),this.context.stroke()},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.onedit=null,this.clickX=null,this.clickY=null,this.clickZ=null,this.clickDrag=null,this.clickInk=null,this.paint=null,this.startTime=null,this.recog=null,this.recogLv=null,this.recogList=null,this.canvas=null,this.context=null,this.action=null,this.backSpace=null,this.spaceBar=null,this.doneKey=null,this.dlist=null,this._promise&&this._promise.cancel(),this._promise=null)}}),Speak:WinJS.Class.define(function(t,e){var n=this;this.element=t,t.winControl=this,utils.addClass(this.element,"speak-control"),utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.listenButton=document.createElement("div"),this.listenButton.className="listen";var i=document.createElement("i");i.className="md md-keyboard-voice",this.listenButton.appendChild(i),this.listenButton.onclick=function(){utils.hasClass(n.element,"active")?n.stopRecord():n.startRecord()},this.element.appendChild(this.listenButton),this.waveA=document.createElement("div"),this.waveA.className="wave",this.element.appendChild(this.waveA),this.waveB=document.createElement("div"),this.waveB.className="wave2",this.element.appendChild(this.waveB),this.progress=document.createElement("progress"),this.element.appendChild(this.progress),this.initDevice()},{initDevice:function(){this.captureInitSettings=null,this.captureInitSettings=new Windows.Media.Capture.MediaCaptureInitializationSettings,this.captureInitSettings.audioDeviceId="",this.captureInitSettings.videoDeviceId="",this.captureInitSettings.streamingCaptureMode=Windows.Media.Capture.StreamingCaptureMode.audio,this.systemMediaControls=Windows.Media.SystemMediaTransportControls.getForCurrentView()},releaseDevice:function(){"recording"!=this.recordState&&null==this.mediaCaptureMgr||(utils.removeClass(this.element,"active"),clearInterval(this.checkTime),this.recordState=null,this.mediaCaptureMgr.close(),this.mediaCaptureMgr=null,app.removeEventListener("checkpoint",this.releaseDevice),this.systemMediaControls.onpropertychanged=null)},startRecord:function(){var t=this;utils.addClass(this.element,"active"),null==this.mediaCaptureMgr&&(this.mediaCaptureMgr=new Windows.Media.Capture.MediaCapture,WinJS.Application.addEventListener("checkpoint",this.releaseDevice),this.systemMediaControls.onpropertychanged=function(e){e.property===Windows.Media.SystemMediaTransportControlsProperty.soundLevel&&(e.target.soundLevel===Windows.Media.SoundLevel.muted?t.releaseDevice():t.initDevice())}),this.mediaCaptureMgr.initializeAsync(this.captureInitSettings).then(function(){t.checkTime=setInterval(function(){t.stopRecord()},1e4),t.recordState="recording";var e=Windows.Media.MediaProperties.MediaEncodingProfile.createWav(Windows.Media.MediaProperties.AudioEncodingQuality.auto);return e.audio.sampleRate=16e3,e.audio.channelCount=1,t.soundStream=new Windows.Storage.Streams.InMemoryRandomAccessStream,t.mediaCaptureMgr.startRecordToStreamAsync(e,t.soundStream)}).then(null,function(){})},stopRecord:function(){var t=this;clearInterval(this.checkTime),utils.removeClass(this.element,"active"),"recording"==this.recordState&&(Custom.Utils.showNotif(WinJS.Resources.getString("recognizing").value),utils.addClass(this.element,"loading"),this.mediaCaptureMgr.stopRecordAsync().then(function(){t.recordState=null,t.mediaCaptureMgr.close(),t.mediaCaptureMgr=null,app.removeEventListener("checkpoint",t.release),t.systemMediaControls.onpropertychanged=null;var e=MSApp.createBlobFromRandomAccessStream("audio/l16",t.soundStream);t.soundStream=null;var n="undefined"!=typeof localSettings.values.https?localSettings.values.https:!1,i=1==n?"https":"http",s=i+"://www.google.com/speech-api/v2/recognize?output=json&lang="+localSettings.values.inputLang+"&key=AIzaSyBOti4mM-6x9WDnZIjIeyEU21OpBXqWBgw";t._promise&&t._promise.cancel(),t._promise=WinJS.xhr({type:"POST",url:s,data:e,headers:{"Content-Type":"audio/l16; rate=16000"}}).then(function(e){utils.removeClass(t.element,"loading"),Custom.Utils.hideNotif();var n=e.response;if(n.length>14){n=n.substring(14,n.length);var i=JSON.parse(n).result[0].alternative[0].transcript;t.callEvent(0,i),t.callEvent(2)}},function(){Custom.Utils.popupNoInternet(),Custom.Utils.hideNotif(),utils.removeClass(t.element,"loading")})}))},callEvent:function(t,e){this.dispatchEvent("edit",{eType:t,eText:e})},dispose:function(){this._disposed||(this._disposed=!0,utils.disposeSubTree(this.element),this.onedit=null,this.releaseDevice(),this.listenButton=null,this.waveA=null,this.waveB=null,this.progress=null,this.soundStream=null,this.recordState=null,this.checkTime=null,this.captureInitSettings=null,this.mediaCaptureMgr=null,this.systemMediaControls=null,this._promise&&this._promise.cancel(),this._promise=null)}}),Dictionary:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.type=e.type,this.element.onclick=this._navtoDict.bind(this)},{dict:{get:function(){return this._dict},set:function(t){this._dict=t,t.length>0?this.element.hidden=!1:this.element.hidden=!0}},_navtoDict:function(){nav.navigate("/pages/p-dict/p-dict.html",{dict:this.dict,title:this.title,type:this.type,source:this.source})}}),SetData:WinJS.Class.define(function(t,e){this.element=t,t.winControl=this,utils.addClass(this.element,"win-disposable"),this._disposed=!1,this.type=e.type,this.element.onclick=this._setData.bind(this)},{_setData:function(){var t=Custom.Navigation.navigator.pageControl;t.bindingData.inputLang=this.inputLang,t.bindingData.outputLang=this.outputLang,t.bindingData.inputText=this.inputText}})}),WinJS.Class.mix(Custom.Control.Write,WinJS.Utilities.createEventProperties("edit"),WinJS.UI.DOMEventMixin),WinJS.Class.mix(Custom.Control.Speak,WinJS.Utilities.createEventProperties("edit"),WinJS.UI.DOMEventMixin)}(),function(){"use strict";WinJS.Namespace.define("Custom.Converter",{languageString:WinJS.Binding.converter(function(t){return"auto"==t?WinJS.Resources.getString("auto").value:WinJS.Resources.getString(t).value}),swapDisabled:WinJS.Binding.converter(function(t){return"auto"==t}),speechDisabled:WinJS.Binding.converter(function(t){var e="md md md-keyboard-voice";if("auto"==t)return e+" disabled";var n=["af","ar","eu","bg","ca","zh","hr","cs","nl","tl","fi","fr","gl","de","iw","hi","hu","is","id","it","ja","ko","ms","no","pl","pt","ro","ru","sr","sk","es","sv","th","tr","uk","vi","zu","en"];return n.indexOf(t)>-1?e:e+" disabled"}),gestureDisabled:WinJS.Binding.converter(function(t){var e=["hy","ka","ig","ha","yo","yi","st","my","si","kk","tg","uz","tlh","otq","yua"];return e.indexOf(t)>-1}),cameraDisabled:WinJS.Binding.converter(function(t){var e="md md-camera-alt",n=["en","zh","zh-TW","ce","da","nl","fi","fr","de","el","hu","it","ja","ko","no","pl","pt","ru","es","sv","tr"];return n.indexOf(t)>-1?e:e+" disabled"}),voiceDisabled:WinJS.Binding.converter(function(t){var e=["af","sq","ar","hy","bs","ca","zh","zh-TW","hr","cs","da","nl","en","eo","fi","fr","de","el","ht","hi","hu","is","id","it","ja","ko","la","lv","mk","no","pl","pt","ro","ru","sr","sk","es","sw","sv","ta","th","tr","vi","cy"];return!(e.indexOf(t)>-1)}),forwardDisabled:WinJS.Binding.converter(function(t){return!(t.trim().length>0)})})}(),function(){"use strict";function t(){Custom.Data.languageList.splice(0,Custom.Data.languageList.length),Custom.Data.langArr.forEach(function(t){Custom.Data.languageList.push({language_id:t,language_name:WinJS.Resources.getString(t).value,main:1})}),Custom.Data.languageList.sort(function(t,e){var n=t.language_name,i=e.language_name;return n.localeCompare(i)})}var e=["af","sq","ar","hy","az","eu","be","bn","bs","bg","ca","ceb","ny","zh","zh-TW","hr","cs","da","nl","en","eo","et","tl","fi","fr","gl","ka","de","el","gu","ht","ha","iw","hi","hmn","hu","is","ig","id","ga","it","ja","jw","kn","kk","km","ko","lo","la","lv","lt","mk","mg","ms","ml","mt","mi","mr","mn","my","ne","no","fa","pl","pt","pa","ro","ru","sr","st","si","sk","sl","so","es","su","sw","sv","tg","ta","te","th","tr","uk","ur","uz","vi","cy","yi","yo","zu","tlh","otq","yua"],n=new WinJS.Binding.List([{name:"light",hex:"#fff",thex:"#000"},{name:"dark",hex:"#000",thex:"#fff"}]),i=new WinJS.Binding.List([{name:"red",statusbar:{r:211,g:47,b:47,a:1},hex:"#F44336"},{name:"pink",statusbar:{r:194,g:24,b:91,a:1},hex:"#E91E63"},{name:"purple",statusbar:{r:123,g:31,b:162,a:1},hex:"#9C27B0"},{name:"deep-purple",statusbar:{r:81,g:45,b:168,a:1},hex:"#673AB7"},{name:"indigo",statusbar:{r:48,g:63,b:159,a:1},hex:"#3F51B5"},{name:"blue",statusbar:{r:13,g:71,b:161,a:1},hex:"#1976D2"},{name:"light-blue",statusbar:{r:1,g:87,b:155,a:1},hex:"#0288D1"},{name:"cyan",statusbar:{r:0,g:151,b:167,a:1},hex:"#00BCD4"},{name:"teal",statusbar:{r:0,g:121,b:107,a:1},hex:"#009688"},{name:"green",statusbar:{r:56,g:142,b:60,a:1},hex:"#4CAF50"},{name:"light-green",statusbar:{r:85,g:139,b:47,a:1},hex:"#689f38"},{name:"deep-orange",statusbar:{r:230,g:74,b:25,a:1},hex:"#FF5722"},{name:"brown",statusbar:{r:93,g:64,b:55,a:1},hex:"#795548"},{name:"grey",statusbar:{r:33,g:33,b:33,a:1},hex:"#616161"},{name:"blue-grey",statusbar:{r:69,g:90,b:100,a:1},hex:"#607D8B"}]),s=new WinJS.Binding.List([]),a=s.createGrouped(function(t){return t.main},function(t){return{main:t.main}},function(t,e){return t-e});WinJS.Namespace.define("Custom.Data",{langArr:e,languageList:s,groupedlanguageList:a,loadlanguageList:t,themeXList:n,themeYList:i})}(),function(){"use strict";var t=Windows.ApplicationModel.Activation,e=WinJS.Application,n=WinJS.Navigation,i=WinJS.Utilities.Scheduler,s=WinJS.UI;WinJS.Utilities,Windows.ApplicationModel.Resources.Core;WinJS.Binding.optimizeBindingReferences=!0;var a=Windows.Storage.ApplicationData.current,o=a.localSettings;e.onactivated=function(a){var r=WinJS.Promise.as().then(function(){var e=Windows.Globalization.ApplicationLanguages.languages[0];if("zh-CN"==e&&"undefined"!=typeof o.values["chinese-server"]&&(o.values["chinese-server"]=!0),a.detail.previousExecutionState!==t.ApplicationExecutionState.terminated&&Custom.Device.isPhone&&"en-US"==e){var n=new Windows.Foundation.Uri("ms-appx:///cortana.xml");Windows.Storage.StorageFile.getFileFromApplicationUriAsync(n).then(function(t){return Windows.Media.SpeechRecognition.VoiceCommandManager.installCommandSetsFromStorageFileAsync(t)}).then(function(){var t=[];return Custom.Data.langArr.forEach(function(e){t.push(WinJS.Resources.getString(e).value)}),Windows.Media.SpeechRecognition.VoiceCommandManager.installedCommandSets.lookup("ModernTranslator").setPhraseListAsync("outputLang",t)}).then(null,function(t){})}return Custom.UI.applyTheme().then(function(){return Custom.UI.applyStatusbar()}).then(function(){return Custom.SQLite.setupDatabase()})}).then(function(){if(1!=o.values.tile_fixed&&Windows.UI.StartScreen.SecondaryTile.findAllAsync().then(function(t){t.forEach(function(t){t.requestDeleteAsync()})}).then(function(){o.values.tile_fixed=!0}),a.detail.kind==t.ActivationKind.protocol){var i=a.detail.uri;return n.history=e.sessionState.history||{},n.history.current.initialPlaceholder=!0,s.disableAnimations(),s.processAll().then(function(){if(Custom.Data.loadlanguageList(),"translate"==i.path){var t=new Windows.Foundation.WwwFormUrlDecoder(i.query);try{var s=t.getFirstValueByName("inputlang"),a=t.getFirstValueByName("outputlang"),r=t.getFirstValueByName("inputtext");(s&&Custom.Data.langArr.indexOf(s)>-1||"auto"==s)&&(o.values.inputLang=s),a&&Custom.Data.langArr.indexOf(a)>-1&&(o.values.outputLang=a),e.sessionState.inputText=r}catch(l){}}return n.navigate(n.location||Custom.Navigation.navigator.home,n.state)})}if(a.detail.kind===t.ActivationKind.shareTarget){var r=a.detail.shareOperation;if(r.data.contains(Windows.ApplicationModel.DataTransfer.StandardDataFormats.text))return r.data.getTextAsync().then(function(t){return n.history=e.sessionState.history||{},n.history.current.initialPlaceholder=!0,s.disableAnimations(),s.processAll().then(function(){return Custom.Data.loadlanguageList(),e.sessionState.inputText=t,n.navigate(Custom.Navigation.navigator.home)})},function(t){r.reportError()})}if(a.detail.kind===t.ActivationKind.voiceCommand){for(var l=a.detail.result,u=(l.rulePath[0],l.semanticInterpretation.properties.inputText[0]),c=l.semanticInterpretation.properties.outputLang[0],d="en",h=0;h<Custom.Data.langArr.length;h++){var p=Custom.Data.langArr[h],m=WinJS.Resources.getString(p).value;if(c==m){d=p;break}}return n.history=e.sessionState.history||{},n.history.current.initialPlaceholder=!0,s.disableAnimations(),s.processAll().then(function(){return Custom.Data.loadlanguageList(),o.values.inputLang="auto",o.values.outputLang=d,e.sessionState.inputText=u,n.navigate(Custom.Navigation.navigator.home)})}return a.detail.kind===t.ActivationKind.pickFileContinuation?(s.disableAnimations(),s.processAll().then(function(){return a.detail.detail[0].files[0]?n.navigate("/pages/p-camera/p-camera.html",{file:a.detail.detail[0].files[0]}):void 0})):a.detail.kind===t.ActivationKind.launch?(n.history=e.sessionState.history||{},n.history.current.initialPlaceholder=!0,s.disableAnimations(),s.processAll().then(function(){if(Custom.Data.loadlanguageList(),"tile_shortcut"==a.detail.arguments.substr(0,13)){var t=a.detail.arguments.substr(13,a.detail.arguments.length-13).split("_");return o.values.inputLang=t[0],o.values.outputLang=t[1],e.sessionState.inputText="",n.navigate(Custom.Navigation.navigator.home)}return n.navigate(n.location||Custom.Navigation.navigator.home,n.state)})):void 0}).then(function(){return i.requestDrain(i.Priority.aboveNormal+1)}).then(function(){s.enableAnimations()});r.done(),a.setPromise(r)},e.onbackclick=function(t){if("/pages/home/home.html"==n.history.current.location){var e=Custom.Navigation.navigator.pageControl;if("hidden"!=e.bindingData.selectMode)return e.bindingData.selectMode="hidden",!0;if(""!=e.bindingData.imeMode)return e.bindingData.imeMode="",!0;if(1==e.bindingData.expandinputBox)return e.bindingData.expandinputBox=!1,!0}},e.oncheckpoint=function(t){if(e.sessionState.history=n.history,
window.soundPromise&&window.soundPromise.cancel(),null!=window.dispRequest&&(window.dispRequest.requestRelease(),window.dispRequest=null),"/pages/home/home.html"==n.history.current.location){var i=Custom.Navigation.navigator.pageControl;""!=i.bindingData.imeMode&&(i.bindingData.imeMode="")}if("/pages/p-livecamera/p-livecamera.html"==n.history.current.location){var i=Custom.Navigation.navigator.pageControl;i.disposeCamera()}},e.start()}(),function(){"use strict";var t=WinJS.Navigation;WinJS.Namespace.define("Custom.Navigation",{PageControlNavigator:WinJS.Class.define(function(e,n){function i(t,e,n,i){t.addEventListener(e,n,i),s._eventHandlerRemover.push(function(){t.removeEventListener(e,n)})}this._element=e||document.createElement("div"),this._element.appendChild(this._createPageElement()),this.home=n.home,this._eventHandlerRemover=[];var s=this;i(t,"navigating",this._navigating.bind(this),!1),i(t,"navigated",this._navigated.bind(this),!1),window.onresize=this._resized.bind(this),Custom.Navigation.navigator=this},{home:"",_element:null,_lastNavigationPromise:WinJS.Promise.as(),_lastViewstate:0,pageControl:{get:function(){return this.pageElement&&this.pageElement.winControl}},pageElement:{get:function(){return this._element.firstElementChild}},dispose:function(){if(!this._disposed){this._disposed=!0,WinJS.Utilities.disposeSubTree(this._element);for(var t=0;t<this._eventHandlerRemover.length;t++)this._eventHandlerRemover[t]();this._eventHandlerRemover=null}},_createPageElement:function(){var t=document.createElement("div");return t.setAttribute("dir",window.getComputedStyle(this._element,null).direction),t.style.position="absolute",t.style.visibility="hidden",t.style.width="100%",t.style.height="100%",t},_getAnimationElements:function(){return this.pageControl&&this.pageControl.getAnimationElements?this.pageControl.getAnimationElements():this.pageElement.querySelector(".material-content")},_navigated:function(){this.pageElement.style.visibility="",WinJS.UI.Animation.enterPage(this._getAnimationElements()).done(),WinJS.Resources.processAll(this.pageElement)},_navigating:function(t){function e(){if(i._element.childElementCount>1){var t=i._element.firstElementChild;t.winControl&&(t.winControl.unload&&t.winControl.unload(),t.winControl.dispose()),t.parentNode.removeChild(t),t.innerText=""}}var n=this._createPageElement();this._element.appendChild(n),this._lastNavigationPromise.cancel();var i=this;this._lastNavigationPromise=WinJS.Promise.as().then(function(){return WinJS.UI.Pages.render(t.detail.location,n,t.detail.state)}).then(e,e),t.detail.setPromise(this._lastNavigationPromise)},_resized:function(t){this.pageControl&&this.pageControl.updateLayout&&this.pageControl.updateLayout.call(this.pageControl,this.pageElement)}})})}(),function(){"use strict";function t(t){return t.reduce(function(t,e){return t.then(e)},WinJS.Promise.wrap())}function e(t,e){return t.executeAsync("BEGIN TRANSACTION").then(e).then(function(e){var n=e;return t.executeAsync("COMMIT").then(function(){return n})},function(e){var n=e;return t.executeAsync("COMMIT").then(function(){throw n})})}function n(n,i){var s=i.map(function(t){return n.executeAsync.bind(n,t)});return e(n,function(){return t(s)})}function i(n,i){var s=i.map(function(t){return n.bindAndExecuteAsync.bind(n,t.statement,t.parameters)});return e(n,function(){return t(s)})}function s(t,e,n){return WinJS.Promise.as().then(function(){var i=[],s="(",a="(",o=-1;for(var r in n)if(n.hasOwnProperty(r)){var l=n[r];if(null==l)continue;o++,o>0&&(s+=", ",a+=","),s+=r,a+="?","string"!=typeof l&&(l=JSON.stringify(l)),n[r]=l,i.push(n[r])}s+=")",a+=")";var u="INSERT INTO "+e+" "+s+" VALUES "+a;return t.bindAndExecuteAsync(u,i)}).then(function(){var e="SELECT last_insert_rowid();";return t.executeAsync(e)}).then(function(t){return n.id=t[0].getFirstValueByName("last_insert_rowid()"),n})}function a(t){var e={};return t.forEach(function(t){e[t.name]=t.value}),e}function o(){return SQLite.Database.openDatabaseInFolderAsync(Windows.Storage.ApplicationData.current.localFolder,"ft.db").then(function(t){return Custom.SQLite.localDatabase=t,Custom.SQLite.executeStatementsAsTransactionAsync(Custom.SQLite.localDatabase,["CREATE TABLE IF NOT EXISTS history (id INTEGER PRIMARY KEY AUTOINCREMENT, inputLang TEXT NOT NULL, outputLang TEXT NOT NULL, inputText TEXT NOT NULL, outputText TEXT NOT NULL, inputRoman TEXT, outputRoman TEXT, inputDict TEXT, outputDict TEXT, source TEXT NOT NULL);","CREATE TABLE IF NOT EXISTS favorites (id INTEGER PRIMARY KEY AUTOINCREMENT, history_id INTEGER, inputLang TEXT NOT NULL, outputLang TEXT NOT NULL, inputText TEXT NOT NULL, outputText TEXT NOT NULL, inputRoman TEXT, outputRoman TEXT, inputDict TEXT, outputDict TEXT, source TEXT NOT NULL);"])})}var r=(WinJS.Application,WinJS.Utilities.Scheduler,Windows.Storage.ApplicationData.current);r.localSettings;WinJS.Namespace.define("Custom.SQLite",{localDatabse:null,executeAsTransactionAsync:e,executeStatementsAsTransactionAsync:n,bindAndExecuteStatementsAsTransactionAsync:i,insertObject:s,entriestoObj:a,setupDatabase:o})}(),function(){"use strict";function getGoogleTkk(){if(null===sessionStorage.getItem("googleTkk")){var url="https://translate.google.com";return WinJS.xhr({url:url,responseType:"text"}).then(function(t){return t.response}).then(function(body){var startStr="TKK=eval(",endStr=");WEB_TRANSLATION_PATH=",startI=body.indexOf(startStr)+startStr.length,endI=body.indexOf(endStr),tkkEval=body.substring(startI,endI),x=eval(eval(tkkEval));return sessionStorage.setItem("googleTkk",x),sessionStorage.getItem("googleTkk")})}return WinJS.Promise.as(sessionStorage.getItem("googleTkk"))}function b(t,e){for(var n=0;n<e.length-2;n+=3){var i=e.charAt(n+2),i=i>="a"?i.charCodeAt(0)-87:Number(i),i="+"==e.charAt(n+1)?t>>>i:t<<i;t="+"==e.charAt(n)?t+i&4294967295:t^i}return t}function TL(t,e){for(var n=t.split("."),i=Number(n[0])||0,s=[],a=0,o=0;o<e.length;o++){var r=e.charCodeAt(o);128>r?s[a++]=r:(2048>r?s[a++]=r>>6|192:(55296==(64512&r)&&o+1<e.length&&56320==(64512&e.charCodeAt(o+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++o)),s[a++]=r>>18|240,s[a++]=r>>12&63|128):s[a++]=r>>12|224,s[a++]=r>>6&63|128),s[a++]=63&r|128)}for(e=i,a=0;a<s.length;a++)e+=s[a],e=b(e,"+-a^+6");return e=b(e,"+-3^+b+-f"),e^=Number(n[1])||0,0>e&&(e=(2147483647&e)+2147483648),e%=1e6,e.toString()+"."+(e^i)}function translateByGoogle(t,e,n){return WinJS.Promise.as().then(function(){return encodeURIComponent(n).length>1e3?WinJS.Promise.as().then(function(){for(var i=n.substr(0,100),s=200;s<n.length&&!(encodeURIComponent(n.substr(0,s)).length>1e3);s+=100)i=n.substr(0,s);var a=i.lastIndexOf(" ");-1==a&&(a=i.length-1);var o,r,l=i.substr(0,a),u=n.substr(a+1,n.length-l.length),c=[];return c.push(Custom.Translate.translateByGoogle(t,e,l).then(function(t){o=t})),c.push(Custom.Translate.translateByGoogle(t,e,u).then(function(t){r=t})),WinJS.Promise.join(c).then(function(){return o&&r?{inputLang:o.inputLang,suggestedinputLang:o.outputLang,inputText:o.inputText+r.inputText,suggestedinputText:null,inputRoman:o.inputRoman+r.inputRoman,inputDict:"",outputLang:e,outputText:o.outputText+r.outputText,outputRoman:o.outputRoman+r.outputRoman,outputDict:"",source:"google"}:void 0})}):getGoogleTkk().then(function(i){var s=encodeURI(Custom.Utils.getDomain()+"/translate_a/single?client=t&sl="+t+"&tl="+e+"&hl=en&dt=bd&dt=ex&dt=ld&dt=md&dt=qc&dt=rw&dt=rm&dt=ss&dt=t&dt=at&ie=UTF-8&oe=UTF-8&prev=btn&ssel=4&tsel=4&tk="+TL(i,n)+"&q="+n);return WinJS.xhr({type:"get",url:s,responseType:"json"})}).then(function(t){var i=t.response;i=Custom.Utils.standardlizeJSON(i);var s=JSON.parse(i),a="",o="",r="";s[0]&&s[0].forEach(function(t){t[0]&&(a+=t[0]),t[0]||(t[2]&&(r+=t[2]),t[3]&&(o+=t[3]))});var l=s[2];"zh-CN"==l&&(l="zh");var u;(s[11]||s[12]||s[13]||s[14])&&(u=[s[11],s[12],s[13],s[14]]);var c,u=u,d=s[1];s[8]&&(c=s[8][0][0]),"zh-CN"==c&&(c="zh");var h;return s[7]&&(h=s[7][1]),{inputLang:l,suggestedinputLang:c,inputText:n,suggestedinputText:h,inputRoman:o,inputDict:u?JSON.stringify(u):"",outputLang:e,outputText:a,outputRoman:r,outputDict:d?JSON.stringify(d):"",source:"google"}})})}function translateinBatchByGoogle(t,e,n){return getGoogleTkk().then(function(i){for(var s=Custom.Utils.getDomain()+"/translate_a/t?client=mt&sl="+t+"&tl="+e+"&hl=en&v=1.0&tk="+TL(i,n.join("")),a=[],o=0;o<n.length;o++){if(encodeURI(s+"&q"+n[o]).length>2e3){a=n.slice(o,n.length);break}s+="&q=",s+=n[o]}return s=encodeURI(s),WinJS.xhr({type:"get",url:s,responseType:"json"})}).then(function(t){return JSON.parse(t.response)})}function translateByBing(t,e,n){return WinJS.Promise.as().then(function(){if(app.sessionState.bingAppId)return app.sessionState.bingAppId;var t="http://www.bing.com/translator/dynamic/213366/js/LandingPage.js";return WinJS.xhr({type:"get",url:t}).then(function(t){return app.sessionState.bingAppId=t.response.substr(t.response.indexOf("appId:")+6,47),app.sessionState.bingAppId})}).then(function(i){var s=t;"auto"==s?s="":"zh"==s?s="zh-CHS":"zh-TW"==s&&(s="zh-CHT");var a=e;"zh"==a?a="zh-CHS":"zh-TW"==a&&(a="zh-CHT");var o=n.split("\n"),r=encodeURI("http://api.microsofttranslator.com/v2/ajax.svc/TranslateArray2?appId="+i+"&texts="+JSON.stringify(o)+"&from="+s+"&to="+a+"&options={}");return WinJS.xhr({type:"get",url:r,responseType:"json"}).then(function(i){var s=JSON.parse(i.response);if("object"!=typeof s)throw app.sessionState.bingAppId=null,"appid_expired";"auto"==t&&(t=s[0].From,"zh-CHS"==t?t="zh":"zh-CHT"==t&&(t="zh-TW"));var a="";return s.forEach(function(t){a+=t.TranslatedText+"\n"}),{inputLang:t,suggestedinputLang:null,inputText:n,suggestedinputText:null,inputRoman:"",inputDict:"",outputLang:e,outputText:a,outputRoman:"",outputDict:"",source:"bing"}})}).then(function(i){if(n.indexOf(" ")>-1)return i;var s=encodeURI("http://www.microsofttranslator.com/dictionary.ashx?from="+t+"&to="+e+"&text="+n);return WinJS.xhr({type:"get",url:s,responseType:"json"}).then(function(t){return t.response.length<=25?i:(i.outputDict=t.response.substring(21,t.response.length-4),i)},function(t){return i})})}function translateinBatchByBing(t,e,n){return WinJS.Promise.as().then(function(){if(app.sessionState.bingAppId)return app.sessionState.bingAppId;var t="http://www.bing.com/translator/dynamic/0/js/LandingPage.js";return WinJS.xhr({type:"get",url:t}).then(function(t){return app.sessionState.bingAppId=t.response.substr(459,47),app.sessionState.bingAppId})}).then(function(i){"auto"==t?t="":"zh"==t?t="zh-CHS":"zh-TW"==t&&(t="zh-CHT");var s=JSON.stringify(n),a=encodeURI("http://api.microsofttranslator.com/v2/ajax.svc/TranslateArray2?appId="+i+"&texts="+s+"&from="+t+"&to="+e+"&options={}");return WinJS.xhr({type:"get",url:a,responseType:"json"}).then(function(t){var e=JSON.parse(t.response);if("object"!=typeof e)throw app.sessionState.bingAppId=null,"appid_expired";var n=[];return e.forEach(function(t){n.push(t.TranslatedText)}),n})})}function translate(t,e,n){return WinJS.Promise.as().then(function(){return n.length<1?void 0:["tlh","otq","yua"].indexOf(t)>-1?supportedbyBing.indexOf(e)>-1?Custom.Translate.translateByBing(t,e,n):Custom.Translate.translateByBing(t,"en",n).then(function(t){return Custom.Translate.translateByGoogle("en",e,t.outputText)}):["tlh","otq","yua"].indexOf(e)>-1?supportedbyBing.indexOf(t)>-1?Custom.Translate.translateByBing(t,e,n):Custom.Translate.translateByGoogle(t,"en",n).then(function(t){return Custom.Translate.translateByBing("en",e,t.outputText)}):1==localSettings.values.bing&&supportedbyBing.indexOf(t)>-1&&supportedbyBing.indexOf(e)>-1?Custom.Translate.translateByBing(t,e,n):Custom.Translate.translateByGoogle(t,e,n)}).then(null,function(t){})}function translateinBatch(t,e,n){return WinJS.Promise.as().then(function(){return["tlh","otq","yua"].indexOf(t)>-1?supportedbyBing.indexOf(e)>-1?Custom.Translate.translateinBatchByBing(t,e,n):Custom.Translate.translateinBatchByBing(t,"en",n).then(function(t){return Custom.Translate.translateinBatchByGoogle("en",e,t)}):["tlh","otq","yua"].indexOf(e)>-1?supportedbyBing.indexOf(t)>-1?Custom.Translate.translateinBatchByBing(t,e,n):Custom.Translate.translateinBatchByGoogle(t,"en",n).then(function(t){return Custom.Translate.translateinBatchByBing("en",e,t.outputText)}):1==localSettings.values.bing&&supportedbyBing.indexOf(t)>-1&&supportedbyBing.indexOf(e)>-1?Custom.Translate.translateinBatchByBing(t,e,n):Custom.Translate.translateinBatchByGoogle(t,e,n)}).then(null,function(t){})}var app=WinJS.Application,applicationData=Windows.Storage.ApplicationData.current,localSettings=applicationData.localSettings,supportedbyBing=["auto","he","pl","ar","hi","pt","bg","ca","hu","ro","zh","id","ru","zh-TW","it","sk","cs","ja","sl","da","es","nl","sv","en","ko","th","et","lv","tr","fi","lt","uk","fr","ms","ur","de","mt","vi","el","no","cy","ht","fa","tlh","otq","yua"];WinJS.Namespace.define("Custom.Translate",{translateByGoogle:translateByGoogle,translateinBatchByGoogle:translateinBatchByGoogle,translateByBing:translateByBing,translateinBatchByBing:translateinBatchByBing,translate:translate,translateinBatch:translateinBatch})}(),function(){"use strict";function t(t){for(var e=document.styleSheets,n=0,i=e.length;i>n;n++)if(e[n].href==t)return;var s=document.createElement("link");s.rel="stylesheet",s.href=t,document.getElementsByTagName("head")[0].appendChild(s)}function e(){return WinJS.Promise.as().then(function(){"undefined"==typeof a.values["x-theme"]&&(a.values["x-theme"]="light"),"undefined"==typeof a.values["y-theme"]&&(a.values["y-theme"]="light-green");var e=a.values["x-theme"],n=a.values["y-theme"];t("/Microsoft.WinJS.4.0/css/ui-"+e+".css"),t("/WinJS.Material/css/material-"+e+".css"),t("/WinJS.Material/css/themes/"+n+".css"),document.body.setAttribute("x-theme",e),document.body.setAttribute("y-theme",n),Custom.Device.isPhone&&i.addClass(document.body,"phone")})}function n(){return WinJS.Promise.as().then(function(){var t=null,e={r:255,g:255,b:255,a:1},n=a.values["y-theme"];if(Custom.Data.themeYList.every(function(e){return e.name==n?(t=e.statusbar,!1):!0}),Custom.Device.isPhone){var i=Windows.UI.ViewManagement.StatusBar.getForCurrentView();0!=a.values.statusbar?t&&(i.backgroundColor=t,i.foregroundColor={r:255,g:255,b:255,a:1},i.backgroundOpacity=1,i.showAsync()):i.hideAsync()}else{var s=Windows.UI.ViewManagement.ApplicationView.getForCurrentView();s.titleBar&&(s.titleBar.backgroundColor=t,s.titleBar.foregroundColor=e,s.titleBar.buttonBackgroundColor=t,s.titleBar.buttonForegroundColor=e)}})}var i=(WinJS.Application,WinJS.Utilities),s=Windows.Storage.ApplicationData.current,a=s.localSettings;WinJS.Namespace.define("Custom.UI",{importCSS:t,applyTheme:e,applyStatusbar:n})}(),function(){"use strict";function t(t){for(var e=0,n="";e<t.length;)if(","==t[e]||"["==t[e])switch(t[e+1]){case",":case"]":n+=t[e]+"null",e++;break;case'"':for(var i=t.substr(e+2),s=i.indexOf('"');"\\"==i[s-1]&&"\\"!=i[s-2];)s=s+1+i.substr(s+1).indexOf('"');s=e+2+s,n+=t.substring(e,s+1),e=s+1;break;default:n+=t[e],e++}else n+=t[e],e++;return n}function e(){return WinJS.Promise.as().then(function(){if("undefined"==typeof u.values.purchased){var t=Windows.ApplicationModel.Store.CurrentApp,e=t.licenseInformation;return e.productLicenses.lookup("premium").isActive?void(u.values.purchased=!0):1==e.isTrial?void(u.values.purchased=!1):t.getAppReceiptAsync().then(function(t){var e=new Windows.Data.Xml.Dom.XmlDocument;e.loadXml(t);var n=new Date(e.getElementsByTagName("AppReceipt")[0].attributes.getNamedItem("PurchaseDate").value),i=new Date("2015-03-29T03:00:00Z");i>=n&&(u.values.purchased=!0)})}}).then(null,function(t){})}function n(){return Custom.Utils.popupMsg(WinJS.Resources.getString("no_internet").value,WinJS.Resources.getString("please_check_internet").value)}function i(t,e){return null==r?(r=new Windows.UI.Popups.MessageDialog(e,t),r.showAsync().then(function(){r=null})):void 0}function s(t){if(Custom.Device.isPhone&&0!=u.values.statusbar){var e=Windows.UI.ViewManagement.StatusBar.getForCurrentView();return e.progressIndicator.progressValue=null,e.progressIndicator.text=t,e.progressIndicator.showAsync()}navProgress.hidden=!1}function a(){if(Custom.Device.isPhone&&0!=u.values.statusbar){var t=Windows.UI.ViewManagement.StatusBar.getForCurrentView();return t.progressIndicator.progressValue=0,t.progressIndicator.hideAsync()}navProgress.hidden=!0}function o(){var t="undefined"!=typeof u.values["chinese-server"]?u.values["chinese-server"]:!1,e="undefined"!=typeof u.values.https?u.values.https:!1;return 1==t?"http://translate.google.cn":e?"https://translate.google.com":"http://translate.google.com"}var r,l=(WinJS.Utilities,Windows.Storage.ApplicationData.current),u=l.localSettings;WinJS.Namespace.define("Custom.Utils",{getPurchaseDateSync:e,standardlizeJSON:t,popupMsg:i,popupNoInternet:n,showNotif:s,hideNotif:a,getDomain:o})}();